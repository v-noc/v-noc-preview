{
  "id": "nodes/6ed537f3-6b8c-43e9-850e-8bfa9835d252",
  "name": "visit_With",
  "node_type": "function",
  "qname": "Jarvis.processing.extProcessor.ExtProcessor.visit_With",
  "file_path": "/Users/yared/Documents/Programing/personal/pythonJaRvis.github.io/Jarvis/tool/Jarvis/processing/extProcessor.py",
  "file_name": "extProcessor",
  "code": "def visit_With(self, node):\n    \"\"\"ID: 6ed537f3-6b8c-43e9-850e-8bfa9835d252\"\"\"\n    current_scope: ScopeItem = self.scope_manager.get_scope(\n        self.current_ns)\n    if_counter = current_scope.inc_while_counter()\n    if_name = utils.get_while_name(if_counter)\n    if_full_ns = utils.join_ns(self.current_ns, if_name)\n    # create a scope for the lambda\n    self.scope_manager.create_scope(if_full_ns, current_scope)\n    if_def = self.def_manager.handle_if_def(\n        self.current_ns, if_name, utils.constants.WHILE_DEF\n    )\n    # add it to the current scope\n    current_scope.add_def(if_name, if_def)\n    for item in node.items:\n        self.visit(item.context_expr)\n        if not item.optional_vars:\n            return\n        self.visit(item.optional_vars)\n        if isinstance(item.context_expr, ast.Call):\n            leftDefi = self.decode_node(item.context_expr.func)\n            self.visit_Call(item.context_expr)\n        else:\n            leftDefi = self.decode_node(item.context_expr)\n        rightNs = self._get_target_ns(item.optional_vars)\n        if rightNs:\n            rightNs = rightNs[0]\n        else:\n            return\n        rightDefi: Definition = self.def_manager.get(rightNs)\n        if not rightDefi:\n            rightDefi = self.def_manager.create(\n                rightNs, utils.constants.NAME_DEF)\n        if leftDefi:\n            if not leftDefi[0]:\n                continue\n            function1Ns = utils.join_ns(leftDefi[0].get_ns(), \"__enter__\")\n            function2Ns = utils.join_ns(leftDefi[0].get_ns(), \"__exit__\")\n\n            # function1Defi = self.def_manager.get(function1Ns)\n            # function2Defi = self.def_manager.get(function2Ns)\n            # function1Defi = self.getYPOint(node.lineno,[function1Ns])\n            # function2Defi = self.getYPOint(node.lineno,[function2Ns])\n            # tmp1 = self.find_field(leftDefi[0].get_ns(),\"__enter__\")\n            # tmp2 = self.find_field(leftDefi[0].get_ns(),\"__exit__\")\n            function1Defi = self.find_field(\n                leftDefi[0].get_ns(), \"__enter__\")\n            function2Defi = self.find_field(\n                leftDefi[0].get_ns(), \"__exit__\")\n            # print(tmp1.get_ns(),tmp2.get_ns())\n\n            # print(function1Defi,function2Defi)\n            # for d in function1Defi:\n            #     self.pushStack(d, isEntry=True)\n            # for d in function2Defi:\n            #     self.pushStack(d, isEntry=True)\n            self.pushStack(function1Defi, isEntry=True)\n            self.pushStack(function2Defi, isEntry=True)\n            leftPoint = self.getYPOint(\n                node.lineno, utils.join_ns(\n                    function1Ns, utils.constants.RETURN_NAME)\n            )\n            self.scope_manager.handle_assign(\n                self.current_ns, rightNs[len(\n                    self.current_ns) + 1:], rightDefi\n            )\n            rightDefi.add_value_point(node.lineno, leftPoint)\n    self.node_manager.add(if_full_ns, node)\n    self.pushStack(if_def)\n    pass\n",
  "position": {
    "line_no": 278,
    "col_offset": 4,
    "end_line_no": 348,
    "end_col_offset": 0
  }
}