{
  "id": "nodes/c82424c4-feb5-40a4-ada0-4a1c508c2cc2",
  "name": "pointers",
  "node_type": "file",
  "qname": "Jarvis.machinery.pointers",
  "file_path": "/Users/yared/Documents/Programing/personal/pythonJaRvis.github.io/Jarvis/tool/Jarvis/machinery/pointers.py",
  "file_name": "pointers",
  "code": "#\n# Copyright (c) 2020 Vitalis Salis.\n#\n# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing,\n# software distributed under the License is distributed on an\n# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n# KIND, either express or implied.  See the License for the\n# specific language governing permissions and limitations\n# under the License.\n#\n\"\"\"FileID: c82424c4-feb5-40a4-ada0-4a1c508c2cc2\"\"\"\nclass Pointer(object):\n    \"\"\"ID: 57070df4-13bf-4c3f-8861-e6b62162285c\"\"\"\n    def __init__(self):\n        \"\"\"ID: cd5d88e9-6f73-4815-bd53-fd6de0dc147f\"\"\"\n        self.values = set()\n\n    def add(self, item):\n        \"\"\"ID: 0f1742a1-6cea-4a0c-b444-3c102a3b89e7\"\"\"\n        self.values.add(item)\n\n    def add_set(self, s):\n        \"\"\"ID: b0aee678-06a1-499d-9d3f-b7cf86be0662\"\"\"\n        self.values = self.values.union(s)\n\n    def get(self):\n        \"\"\"ID: 4d3cec85-141b-442a-8b25-7284af825f6c\"\"\"\n        return self.values\n\n    def merge(self, pointer):\n        \"\"\"ID: e89434ad-ab4a-474f-91c6-fb6e3aa4b7a4\"\"\"\n        self.values = self.values.union(pointer.values)\n\nclass LiteralPointer(Pointer):\n    \"\"\"ID: 2dfd51c6-da03-4e33-834e-836c858e7e51\"\"\"\n    STR_LIT = \"STRING\"\n    INT_LIT = \"INTEGER\"\n    UNK_LIT = \"UNKNOWN\"\n\n    # no need to add the actual item\n    def add(self, item):\n        \"\"\"ID: 817d857a-deee-4b0a-a299-a315684c363b\"\"\"\n        if isinstance(item, str):\n            self.values.add(item)\n        elif isinstance(item, int):\n            self.values.add(item)\n        else:\n            self.values.add(self.UNK_LIT)\n\nclass NamePointer(Pointer):\n    \"\"\"ID: e5cbe80e-187c-4710-ba21-5cc077d3b4ab\"\"\"\n    def __init__(self):\n        \"\"\"ID: 96b55eb7-9551-41e4-a5ec-f896f12053ed\"\"\"\n        super().__init__()\n        self.pos_to_name = {}\n        self.name_to_pos = {}\n        self.args = {}\n\n    def _sanitize_pos(self, pos):\n        \"\"\"ID: 80ef6e3e-2368-4326-bd26-dedd9c298c57\"\"\"\n        try:\n            int(pos)\n        except ValueError:\n            raise PointerError(\"Invalid position for argument\")\n\n        return pos\n\n    def get_or_create(self, name):\n        \"\"\"ID: ba090f37-6f33-4cd1-bcca-9cab8fc15d9e\"\"\"\n        if not name in self.args:\n            self.args[name] = set()\n        return self.args[name]\n\n    def add_arg(self, name, item):\n        \"\"\"ID: 96167dc1-0e4b-43ae-bb0f-74c049272dc7\"\"\"\n        arg = self.get_or_create(name)\n        if isinstance(item, str):\n            self.args[name].add(item)\n        elif isinstance(item, set):\n            self.args[name] = self.args[name].union(item)\n        else:\n            raise Exception()\n\n    def add_lit_arg(self, name, item):\n        \"\"\"ID: cdbf77a3-7b7f-45fc-aa10-b59e5c30710e\"\"\"\n        arg = self.get_or_create(name)\n        if isinstance(item, str):\n            arg.add(LiteralPointer.STR_LIT)\n        elif isinstance(item, int):\n            arg.add(LiteralPointer.INT_LIT)\n        else:\n            arg.add(LiteralPointer.UNK_LIT)\n\n    def add_pos_arg(self, pos, name, item):\n        \"\"\"ID: 9197b271-f8f4-4871-89b7-3d67c6ab65bf\"\"\"\n        pos = self._sanitize_pos(pos)\n        if not name:\n            if self.pos_to_name.get(pos, None):\n                name = self.pos_to_name[pos]\n            else:\n                name = str(pos)\n        self.pos_to_name[pos] = name\n        self.name_to_pos[name] = pos\n\n        self.add_arg(name, item)\n\n    def add_name_arg(self, name, item):\n        \"\"\"ID: 3e984242-f115-4e1d-8d0e-fc7b9509cdb4\"\"\"\n        self.add_arg(name, item)\n\n    def add_pos_lit_arg(self, pos, name, item):\n        \"\"\"ID: d4647bca-dd25-400f-8895-80744e7976f1\"\"\"\n        pos = self._sanitize_pos(pos)\n        if not name:\n            name = str(pos)\n        self.pos_to_name[pos] = name\n        self.name_to_pos[name] = pos\n        self.add_lit_arg(name, item)\n\n    def get_pos_arg(self, pos):\n        \"\"\"ID: 5da12f2a-9abf-4277-9a36-4b2c6a8bf900\"\"\"\n        pos = self._sanitize_pos(pos)\n        name = self.pos_to_name.get(pos, None)\n        return self.get_arg(name)\n\n    def get_arg(self, name):\n        \"\"\"ID: 24e06812-6395-4568-a3e2-695ab2f40996\"\"\"\n        if self.args.get(name, None):\n            return self.args[name]\n\n    def get_args(self):\n        \"\"\"ID: c8e8a254-89c2-4bfc-bb7e-81daa9e105b6\"\"\"\n        return self.args\n\n    def get_pos_args(self):\n        \"\"\"ID: 940078b7-f3a2-4407-962d-1fd079f27eb0\"\"\"\n        args = {}\n        for pos, name in self.pos_to_name.items():\n            args[pos] = self.args[name]\n        return args\n\n    def get_pos_of_name(self, name):\n        \"\"\"ID: 11aab889-36ff-4e52-a76f-b331dbc15c45\"\"\"\n        if name in self.name_to_pos:\n            return self.name_to_pos[name]\n\n    def get_pos_names(self):\n        \"\"\"ID: 9affcc9a-5a6a-473c-a4ac-27ec0c21fa46\"\"\"\n        return self.pos_to_name\n\n    def merge(self, pointer):\n        \"\"\"ID: e0aafc20-fc54-4b2e-9e15-ec781392ece8\"\"\"\n        super().merge(pointer)\n        if hasattr(pointer, \"get_pos_names\"):\n            for pos, name in pointer.get_pos_names().items():\n                self.pos_to_name[pos] = name\n            for name, arg in pointer.get_args().items():\n                self.add_arg(name, arg)\n\nclass PointerError(Exception):\n    \"\"\"ID: 379aecb6-4316-40ac-be1b-0c1c8e2a0b6e\"\"\"\n    pass\n"
}