{
  "id": "nodes/474708f7-92a5-4548-9d21-25cc17e336d8",
  "name": "visit_Import",
  "node_type": "function",
  "qname": "Jarvis.processing.extProcessor.ExtProcessor.visit_Import",
  "file_path": "/Users/yared/Documents/Programing/personal/pythonJaRvis.github.io/Jarvis/tool/Jarvis/processing/extProcessor.py",
  "file_name": "extProcessor",
  "code": "    def visit_Import(self, node, prefix=\"\", level=0):\n        \"\"\"For imports of the form\n    `from something import anything`\nprefix is set to \"something\".\nFor imports of the form\n    `from .relative import anything`\nlevel is set to a number indicating the number\nof parent directories (e.g. in this case level=1)\n\nID: 474708f7-92a5-4548-9d21-25cc17e336d8\"\"\"\n\n        def handle_src_name(name):\n            \"\"\"ID: d24f0c0d-a48a-43f3-b7ac-592904135cbe\"\"\"\n            # Get the module name and prepend prefix if necessary\n            src_name = name\n            if prefix:\n                src_name = prefix + \".\" + src_name\n            return src_name\n\n        def handle_scopes(imp_name, tgt_name, modname):\n            \"\"\"ID: 6a6c3990-1bae-4be1-b14d-bdbad59b6beb\"\"\"\n            def create_def(scope, name):\n                \"\"\"ID: e52308e5-6d6f-4934-8a73-0679158fc978\"\"\"\n                if name not in scope.get_defs():\n                    def_ns = utils.join_ns(scope.get_ns(), name)\n                    defi = self.def_manager.get(def_ns)\n                    if not defi:\n                        defi = self.def_manager.create(\n                            def_ns, utils.constants.NAME_DEF)\n                    current_scope.add_def(name, defi)\n\n            current_scope = self.scope_manager.get_scope(self.current_ns)\n            imported_scope = self.scope_manager.get_scope(modname)\n            if tgt_name == \"*\":\n                if imported_scope:\n                    for name, defi in imported_scope.get_defs().items():\n                        create_def(current_scope, name)\n                        current_scope.get_def(name).add_value_point(\n                            node.lineno, defi.get_ns()\n                        )\n            else:\n                if imported_scope:\n                    defi = imported_scope.get_def(imp_name)\n                    if not defi:\n                        defi = self.def_manager.get(imp_name)\n                    if not defi:\n                        return\n                    if (\n                            modname == tgt_name\n                            and defi.get_type() != utils.constants.MOD_DEF\n                    ):\n                        create_def(current_scope, tgt_name)\n                        current_scope.get_def(tgt_name).add_value_point(\n                            node.lineno, modname\n                        )\n                    else:\n                        create_def(current_scope, tgt_name)\n                        current_scope.get_def(tgt_name).add_value_point(\n                            node.lineno, defi.get_ns()\n                        )\n\n        # \u52a0\u5165ext_def\uff0c\u4f1a\u51fa\u73b0\u6307\u5411\n        def add_external_def(name, target, row=0):\n            \"\"\"ID: d4c23da1-5f0f-4d31-bd30-1bd52a3916cd\"\"\"\n            # add an external def for the name\n            defi = self.def_manager.get(name)\n            if not defi:\n                defi = self.def_manager.create(name, utils.constants.EXT_DEF)\n            scope = self.scope_manager.get_scope(self.current_ns)\n            if target != \"*\":\n                # add a def for the target that points to the name\n                tgt_ns = utils.join_ns(scope.get_ns(), target)\n                tgt_defi: Definition = self.def_manager.get(tgt_ns)\n                if not tgt_defi:\n                    tgt_defi = self.def_manager.create(\n                        tgt_ns, utils.constants.NAME_DEF)\n                # tgt_defi.add_name_point(row).add(defi.get_ns())\n                tgt_defi.add_value_point(row, defi.get_ns())\n                scope.add_def(target, tgt_defi)\n\n        for import_item in node.names:\n            src_name = handle_src_name(import_item.name)\n            tgt_name = import_item.asname if import_item.asname else import_item.name\n            if src_name == \"tldextract\":\n                print()\n            if tgt_name == \"TLDExtract\":\n                print()\n            imported_name = self.import_manager.handle_import(src_name, level)\n            if not imported_name:\n                add_external_def(src_name, tgt_name, node.lineno)\n                continue\n            fname = self.import_manager.get_filepath(imported_name)\n            if not fname:\n                add_external_def(src_name, tgt_name)\n                continue\n            if not self.decy:\n                if self.import_manager.get_mod_dir() not in fname:\n                    add_external_def(src_name, tgt_name)\n                    continue\n            if fname.endswith(\".py\") and not imported_name in self.modules_analyzed:\n                self.analyze_submodule(imported_name)\n            if not gol.get_value('precision', False):\n                self.cg.add_edge(self.current_ns, imported_name)\n            handle_scopes(import_item.name, tgt_name, imported_name)\n",
  "position": {
    "line_no": 349,
    "col_offset": 4,
    "end_line_no": 453,
    "end_col_offset": 0
  }
}