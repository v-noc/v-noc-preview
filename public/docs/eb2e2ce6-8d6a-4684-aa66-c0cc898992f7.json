[
  {
    "_key": "6b4a0b49-8b2a-4ab1-a259-c97433c56ce6",
    "_id": "documents/6b4a0b49-8b2a-4ab1-a259-c97433c56ce6",
    "created_at": "2026-01-25T21:38:48.132605Z",
    "updated_at": "2026-01-25T21:39:51.894320Z",
    "name": "Overview",
    "description": "overview",
    "data": "[{\"id\":\"34c8c740-0891-4991-b22c-b399e1f0550d\",\"type\":\"paragraph\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Function: _handle_ns\",\"styles\":{\"bold\":true}}],\"children\":[]},{\"id\":\"3a626565-7b3b-46db-9094-d9dc8d1e7a23\",\"type\":\"paragraph\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Description\\n\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\"The \",\"styles\":{}},{\"type\":\"text\",\"text\":\"_handle_ns\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" function is a context-management utility that determines the \\\"true\\\" logical namespace of the current code, ignoring temporary control-flow wrappers. It examines the current analysis stack and traverses backward to skip any namespaces created specifically for \",\"styles\":{}},{\"type\":\"text\",\"text\":\"if\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\", \",\"styles\":{}},{\"type\":\"text\",\"text\":\"else\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\", or \",\"styles\":{}},{\"type\":\"text\",\"text\":\"while\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" blocks, returning the nearest formal namespace (such as a function, class, or module).\",\"styles\":{}}],\"children\":[]},{\"id\":\"fdb09b76-4c95-45d7-9b84-a890d636354a\",\"type\":\"paragraph\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Why this matters\\n\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\"Static analysis often creates \\\"virtual\\\" scopes to handle branching logic (e.g., \",\"styles\":{}},{\"type\":\"text\",\"text\":\"<if_1>\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\", \",\"styles\":{}},{\"type\":\"text\",\"text\":\"<else_2>\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\"). While these are necessary for tracking local variable changes, they are not structural parts of the Python naming hierarchy. If you define a function inside an \",\"styles\":{}},{\"type\":\"text\",\"text\":\"if\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" block, Python considers that function to be a member of the surrounding \",\"styles\":{}},{\"type\":\"text\",\"text\":\"Function\",\"styles\":{\"italic\":true}},{\"type\":\"text\",\"text\":\" or \",\"styles\":{}},{\"type\":\"text\",\"text\":\"Module\",\"styles\":{\"italic\":true}},{\"type\":\"text\",\"text\":\", not a member of the \\\"if\\\" block. \",\"styles\":{}},{\"type\":\"text\",\"text\":\"_handle_ns\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" ensures that structural definitions are assigned to the correct parent namespace rather than a temporary control-flow ID.\",\"styles\":{}}],\"children\":[]},{\"id\":\"ef4f003d-4c43-428f-9bb7-d6ff33d5b7fd\",\"type\":\"paragraph\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"How it works\",\"styles\":{\"bold\":true}}],\"children\":[]},{\"id\":\"32e2d666-119b-4715-a766-3fedc26df9dd\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Stack Snapshot:\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\" It creates a copy of the current \",\"styles\":{}},{\"type\":\"text\",\"text\":\"callStack\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" to avoid modifying the actual analysis state.\",\"styles\":{}}],\"children\":[]},{\"id\":\"081ece76-9d71-4017-8090-04f34a4c24b6\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Parent Search:\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\" It looks at the top item of the stack (the current context).\",\"styles\":{}}],\"children\":[]},{\"id\":\"a40aa799-78ba-4909-9758-54472471365d\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Filter Control Flow:\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\" It checks the type of the current definition. If it is a control flow definition (\",\"styles\":{}},{\"type\":\"text\",\"text\":\"IF_DEF\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\", \",\"styles\":{}},{\"type\":\"text\",\"text\":\"ELSE_DEF\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\", or \",\"styles\":{}},{\"type\":\"text\",\"text\":\"WHILE_DEF\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\"), it \\\"pops\\\" that item and moves to the one below it.\",\"styles\":{}}],\"children\":[]},{\"id\":\"5c27e8a1-de90-4ddc-9393-0ff157687151\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Stop Condition:\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\" It continues this upward traversal until it hits a structural definition (like a \",\"styles\":{}},{\"type\":\"text\",\"text\":\"FunctionDef\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\", \",\"styles\":{}},{\"type\":\"text\",\"text\":\"ClassDef\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\", or \",\"styles\":{}},{\"type\":\"text\",\"text\":\"Module\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\").\",\"styles\":{}}],\"children\":[]},{\"id\":\"d0420823-7d01-4d2b-ad22-cabf10e83ac3\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Return Namespace:\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\" It returns the namespace of this structural parent.\",\"styles\":{}}],\"children\":[]},{\"id\":\"ecb4f2af-d4b1-442b-97ca-a170fc1c0a73\",\"type\":\"paragraph\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Example Scenario\\n\",\"styles\":{\"bold\":true}},{\"type\":\"text\",\"text\":\"Consider this code structure:\",\"styles\":{}}],\"children\":[]},{\"id\":\"6975ab44-a041-4c43-b8a9-0cabbf919a11\",\"type\":\"codeBlock\",\"props\":{\"language\":\"python\"},\"content\":[{\"type\":\"text\",\"text\":\"def my_function():\\n    if condition:\\n        # The analyzer is here. The stack looks like:\\n        # [\\\"module\\\", \\\"module.my_function\\\", \\\"module.my_function.<if_1>\\\"]\",\"styles\":{}}],\"children\":[]},{\"id\":\"988bcf80-ec7a-40be-83a1-0dfee2961114\",\"type\":\"paragraph\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"When \",\"styles\":{}},{\"type\":\"text\",\"text\":\"_handle_ns\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" is called:\",\"styles\":{}}],\"children\":[]},{\"id\":\"5478429b-fb31-43d4-a996-352d670b7dc1\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"It sees \",\"styles\":{}},{\"type\":\"text\",\"text\":\"module.my_function.<if_1>\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" at the top.\",\"styles\":{}}],\"children\":[]},{\"id\":\"dfd8da29-4f16-4d00-b7d9-b3c47c9e73c6\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"It identifies this as an \",\"styles\":{}},{\"type\":\"text\",\"text\":\"IF_DEF\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" and pops it.\",\"styles\":{}}],\"children\":[]},{\"id\":\"89dfb06b-fd5c-496a-8a13-1867c9021a33\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"It moves to \",\"styles\":{}},{\"type\":\"text\",\"text\":\"module.my_function\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\". This is a \",\"styles\":{}},{\"type\":\"text\",\"text\":\"FUN_DEF\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" (not control flow), so it stops.\",\"styles\":{}}],\"children\":[]},{\"id\":\"eb5bb937-3657-46a6-b55a-ff3e920a76bf\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"It returns \",\"styles\":{}},{\"type\":\"text\",\"text\":\"module.my_function\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\".\",\"styles\":{}}],\"children\":[]},{\"id\":\"9cc7d2b2-bc91-4fea-870e-b5459296e200\",\"type\":\"numberedListItem\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[{\"type\":\"text\",\"text\":\"Any new definitions (like a nested function) will now be correctly parented under \",\"styles\":{}},{\"type\":\"text\",\"text\":\"my_function\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" instead of the temporary \",\"styles\":{}},{\"type\":\"text\",\"text\":\"<if_1>\",\"styles\":{\"code\":true}},{\"type\":\"text\",\"text\":\" block.\",\"styles\":{}}],\"children\":[]},{\"id\":\"68ee43f0-e196-488a-8337-0e86312c9cd5\",\"type\":\"paragraph\",\"props\":{\"backgroundColor\":\"default\",\"textColor\":\"default\",\"textAlignment\":\"left\"},\"content\":[],\"children\":[]}]"
  }
]